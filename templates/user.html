<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>

    <meta
            http-equiv="cache-control"
            content="no-cache, no-store, must-revalidate"
    />
    <meta http-equiv="pragma" content="no-cache"/>
    <meta http-equiv="expires" content="0"/>

    <link rel="preconnect" href="https://fonts.googleapis.com"/>
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin/>
    <link
            href="https://fonts.googleapis.com/css2?family=Rubik:wght@300;700&display=swap"
            rel="stylesheet"
    />
    <link
            rel="stylesheet"
            type="text/css"
            href="{{ url_for('static', filename='styles.css') }}"
    />
    <link
            rel="stylesheet"
            type="text/css"
            href="{{ url_for('static', filename='user-content.css') }}"
    />
    <link rel="shortcut icon" href="{{ url_for('static', filename='favicon.ico') }}">
    <title>KK7 Map Schedule</title>
</head>
<body>
<div class="left-bar">
        <div class="logo">
            <img src="{{ url_for('static', filename='KK_LOGO.png') }}">
        </div>

        <div class="menu">
            <div class="menu-entry">
                <h3><a href="/">Server Overview</a></h3>
            </div>
            <div class="menu-entry">
                <h3><a href="schedule">Search Schedule</a></h3>
            </div>
            <div class="menu-entry">
                <h3><a href="leaderboard">Leaderboard</a></h3>
            </div>
            <div class="menu-entry">
                {% if loginname %}
                    <h3><a href="user">{{ loginname }}</a></h3>
                {% else %}
                    <h3><a href="login">Login/Register</a></h3>
                {% endif %}
            </div>
            {% if loginname %}
                <div class="menu-entry">
                    <h3><a href="logout">Logout</a></h3>
                </div>
            {% endif %}
        </div>
        <div class="countdown">
            <h2>Countdown</h2>
            <h3>{{ timeleft[0] }} Days</h3>
            <h3>{{ timeleft[1] }} Hours</h3>
            <h3>{{ timeleft[2] }} Minutes</h3>
        </div>
    </div>

    <div class="content-area">
        <div class="settings">
            <h3>Hey {{ username }}!</h3><br>
            <br>
        </div>
        <div class="username-container">
            <form id="set_discord_id" method="POST">
                <div class="desc-text">
                    Please add your TM login here, so we can check your fins:
                </div>
                <div class="username-entry-subcell">
                    <div class="username-input">
                        <input type="text" name="tm_id" value="{{ tm_login }}"/>
                        <button type="submit" name="user_save" value="tm_id">Save ID</button>
                    </div>
                </div>
            </form>
        </div>

        <div class="username-container">
            <form id="set_discord_id" method="POST">
                <div class="desc-text">
                    Please add your Discord name and # here to enable alarms (e. g. corkscrew#0875):
                </div>
                <div class="username-entry-subcell">
                    <div class="username-input">
                        <input type="text" name="discord_id" value="{{ discord_id }}"/>
                        <button type="submit" name="user_save" value="discord_id">Save ID</button>
                    </div>
                </div>
            </form>
        </div>


        <div class="alarm-container">
            <form id="save_alarms" method="POST">
                {% for row in range(maplist|count // 5) %}
                    <div class="alarm-row">
                    {% for col in range(5) %}
                        <label class="maplabel">
                        {% if maplist[row * 5 + col] | int in finlist["mapids"] %}
                            <span class="finned">{{ maplist[row * 5 + col] }}</span>
                        {% else %}
                            <span class="unfinned">{{ maplist[row * 5 + col] }}</span>
                        {% endif %}
                        {% if alarm_enabled and maplist[row * 5 + col] in useralarms %}
                            <input type="checkbox" class="alarm-selector" name="alarm_selector"
                                   value="{{ maplist[row * 5 + col] }}" checked="checked"/>
                        {% elif alarm_enabled and maplist[row * 5 + col] not in useralarms %}
                            <input type="checkbox" class="alarm-selector" name="alarm_selector"
                                   value="{{ maplist[row * 5 + col] }}"/>
                        {% else %}
                            <input type="checkbox" class="alarm-selector" name="alarm_selector"
                                   value="{{ maplist[row * 5 + col] }}" disabled="disabled"/>
                        {% endif %}
                        </label>
                    {% endfor %}
                    <!-- Add non-full line, if we have a number of maps that is not divisible by 5 -->
                    </div>
                {% endfor %}
                {% if (maplist|count % 5) > 0 %}
                    <div class="alarm-row">
                        {% for col in range(maplist|count % 5) %}
                            <label class="maplabel">
                                {% if maplist[maplist|count // 5 * 5 + col] | int in finlist["mapids"] %}
                                    <span class="finned">{{ maplist[maplist|count // 5 * 5 + col] }}</span>
                                {% else %}
                                    <span class="unfinned">{{ maplist[maplist|count // 5 * 5 + col] }}</span>
                                {% endif %}
                                {% if alarm_enabled and maplist[maplist|count // 5 * 5 + col] in useralarms %}
                                    <input type="checkbox" class="alarm-selector" name="alarm_selector"
                                           value="{{ maplist[maplist|count // 5 * 5 + col] }}" checked="checked"/>
                                {% elif alarm_enabled and maplist[maplist|count // 5 * 5 + col] not in useralarms %}
                                    <input type="checkbox" class="alarm-selector" name="alarm_selector"
                                           value="{{ maplist[maplist|count // 5 * 5 + col] }}"/>
                                {% else %}
                                    <input type="checkbox" class="alarm-selector" name="alarm_selector"
                                           value="{{ maplist[maplist|count // 5 * 5 + col] }}" disabled="disabled"/>
                                {% endif %}
                            </label>
                        {% endfor %}
                    </div>
                {% endif %}
                <button type="submit" name="user_save" value="alarms">Save Alarms</button>
            </form>
        </div>
    </div>
</body>
</html>
